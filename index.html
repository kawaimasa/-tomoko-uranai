<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”® æ™ºå­ã®å ã„é¤¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #1a0033 0%, #2d1b69 50%, #1a0033 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            width: 100%;
        }

        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 30px;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }

        .fortune-teller-img {
            width: 100%;
            max-width: 500px;
            height: auto;
            display: block;
            margin: 0 auto 30px;
            border-radius: 15px;
            border: 4px solid #ffd700;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .fortune-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .fortune-card {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .fortune-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(255, 215, 0, 0.6);
            border-color: #ffd700;
        }

        .fortune-card h3 {
            color: #ffd700;
            font-size: 1.8em;
            margin-bottom: 15px;
        }

        .fortune-card p {
            color: #e0e0e0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #ffd700;
            font-weight: bold;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1em;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn {
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            color: #1a0033;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 30px rgba(255, 215, 0, 0.6);
        }

        .result-container {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            max-height: 600px;
            overflow-y: auto;
        }

        .chat-message {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
        }

        .chat-message.user {
            background: rgba(255, 215, 0, 0.1);
            border-left: 4px solid #ffd700;
        }

        .chat-message.ai {
            background: rgba(138, 43, 226, 0.1);
            border-left: 4px solid #8a2be2;
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
            color: #ffd700;
        }

        .spinner {
            border: 4px solid rgba(255, 215, 0, 0.3);
            border-top: 4px solid #ffd700;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            margin-top: 20px;
        }

        .question-counter {
            text-align: center;
            color: #ffd700;
            margin-top: 15px;
            font-size: 0.9em;
        }

        .help-text {
            font-size: 0.85em;
            color: #aaa;
            margin-top: 5px;
        }

        .required {
            color: #ff6b6b;
            font-size: 0.9em;
        }

        .optional {
            color: #999;
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”® æ™ºå­ã®å ã„é¤¨</h1>
        
        <img src="https://www.genspark.ai/api/files/s/PnQT1NL1?token=Z0FBQUFBQnBlM0pmd0VVVjBkRjVwbmVZZGNmbGM4TlJEUllRSkRxd2lqd2lnMWIwWkVWbUJYZVpJQkxhSl8yWFA4TUVJY2ppNmhnbFFuYlFpa3c0Z3lZbEtLZkZzWl8wUFp1d21HSzM3MmZYYU1vYTlzdFhFTnlvb2JQV210QVotWGY3ajBka2cxOFBBbGpCMHhOVlpYa2tjQlNSOWJnZWxwNkhVNTZjRzZKTTdyOGFDSF96X1dTdjlUcEhrMkxtb0RKaDQ4N2NlS2ViYnpzUGstM1Zoa0ROZU1YZUF3Y0V6U0ZQVkJSMF9UdWpBM3Y0NWRsYzNYZFdlVjB4dlR0WUU0ZUpIazRaM2RMSWFWTzEtaEZoYWVLRGtua2JkZ3h4ZEE9PQ" 
             alt="æ™ºå­" 
             class="fortune-teller-img"
             onerror="this.style.display='none'">

        <!-- å ã„ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ -->
        <div id="menuScreen" class="screen active">
            <p style="text-align: center; font-size: 1.2em; margin-bottom: 30px;">
                ã‚ˆã†ã“ãã€‚ç§ã¯æ™ºå­ã§ã™ã€‚<br>
                ã©ã®ã‚ˆã†ãªå ã„ã‚’ã”å¸Œæœ›ã§ã™ã‹ï¼Ÿ
            </p>
            
            <div class="fortune-menu">
                <div class="fortune-card" onclick="selectFortune('shichusuimei')">
                    <h3>ğŸŒŸ å››æŸ±æ¨å‘½</h3>
                    <p>ç”Ÿå¹´æœˆæ—¥ã¨æ™‚åˆ»ã‹ã‚‰ã€ã‚ãªãŸã®é‹å‘½ã‚’è©³ã—ãèª­ã¿è§£ãã¾ã™</p>
                </div>
                
                <div class="fortune-card" onclick="selectFortune('tarot')">
                    <h3>ğŸƒ ã‚¿ãƒ­ãƒƒãƒˆå ã„</h3>
                    <p>ã‚«ãƒ¼ãƒ‰ãŒç¤ºã™ã€éå»ãƒ»ç¾åœ¨ãƒ»æœªæ¥ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</p>
                </div>
                
                <div class="fortune-card" onclick="selectFortune('crystal')">
                    <h3>ğŸ”® æ°´æ™¶ç‰å ã„</h3>
                    <p>æ°´æ™¶ã®è¼ãã«æ˜ ã‚‹ã€ã‚ãªãŸã®æœªæ¥</p>
                </div>
                
                <div class="fortune-card" onclick="selectFortune('name')">
                    <h3>âœ¨ å§“ååˆ¤æ–­</h3>
                    <p>ãŠåå‰ã«è¾¼ã‚ã‚‰ã‚ŒãŸé‹å‹¢ã¨æ€§æ ¼ã‚’é‘‘å®š</p>
                </div>
                
                <div class="fortune-card" onclick="selectFortune('comprehensive')">
                    <h3>ğŸŒ™ ç·åˆé‘‘å®š</h3>
                    <p>ã™ã¹ã¦ã®å è¡“ã‚’ä½¿ã£ãŸè©³ç´°ãªé‘‘å®š</p>
                </div>
                
                <div class="fortune-card" onclick="selectFortune('love')">
                    <h3>ğŸ’• æ‹æ„›ãƒ»ç›¸æ€§å ã„</h3>
                    <p>æ‹æ„›é‹ã¨æ°—ã«ãªã‚‹ç›¸æ‰‹ã¨ã®ç›¸æ€§ã‚’å ã„ã¾ã™</p>
                </div>
            </div>
        </div>

        <!-- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ç”»é¢ -->
        <div id="inputScreen" class="screen">
            <h2 id="fortuneTitle" style="text-align: center; color: #ffd700; margin-bottom: 30px;"></h2>
            
            <form id="fortuneForm">
                <div class="form-group" id="birthdateGroup">
                    <label>ç”Ÿå¹´æœˆæ—¥ <span class="required">*å¿…é ˆ</span></label>
                    <input type="date" id="birthdate" required>
                </div>
                
                <div class="form-group" id="birthtimeGroup">
                    <label>
                        å‡ºç”Ÿæ™‚åˆ» <span class="required">*å¿…é ˆ</span>
                        <span class="help-text">ï¼ˆã‚ã‹ã‚‰ãªã„å ´åˆã¯æ­£åˆ12:00ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼‰</span>
                    </label>
                    <input type="time" id="birthtime" value="12:00" required>
                </div>
                
                <div class="form-group" id="nameGroup">
                    <label>ãŠåå‰ <span class="required">*å¿…é ˆ</span></label>
                    <input type="text" id="name" placeholder="å±±ç”°å¤ªéƒ" required>
                </div>
                
                <div class="form-group" id="genderGroup">
                    <label>æ€§åˆ¥ <span class="optional">ï¼ˆä»»æ„ï¼‰</span></label>
                    <select id="gender">
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="ç”·æ€§">ç”·æ€§</option>
                        <option value="å¥³æ€§">å¥³æ€§</option>
                        <option value="ãã®ä»–">ãã®ä»–</option>
                    </select>
                </div>
                
                <div class="form-group" id="partnerNameGroup" style="display: none;">
                    <label>ç›¸æ‰‹ã®ãŠåå‰ <span class="optional">ï¼ˆä»»æ„ï¼‰</span></label>
                    <input type="text" id="partnerName" placeholder="ç›¸æ‰‹ã®åå‰">
                </div>
                
                <div class="form-group" id="partnerBirthdateGroup" style="display: none;">
                    <label>
                        ç›¸æ‰‹ã®ç”Ÿå¹´æœˆæ—¥ <span class="optional">ï¼ˆã‚ã‹ã‚Œã°ï¼‰</span>
                        <span class="help-text">ï¼ˆã‚ã‹ã‚‰ãªãã¦ã‚‚å ãˆã¾ã™ï¼‰</span>
                    </label>
                    <input type="date" id="partnerBirthdate">
                </div>
                
                <div class="form-group" id="questionGroup">
                    <label id="questionLabel">å ã„ãŸã„å†…å®¹ãƒ»è³ªå• <span class="required">*å¿…é ˆ</span></label>
                    <textarea id="question" placeholder="ä¾‹ï¼šä»Šå¹´ã®é‹å‹¢ã‚’çŸ¥ã‚ŠãŸã„ã§ã™" required></textarea>
                </div>
                
                <button type="submit" class="btn">âœ¨ é‹å‘½ã‚’å ã† âœ¨</button>
                <button type="button" class="btn back-btn" onclick="backToMenu()">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>
            </form>
        </div>

        <!-- çµæœè¡¨ç¤ºç”»é¢ -->
        <div id="resultScreen" class="screen">
            <h2 style="text-align: center; color: #ffd700; margin-bottom: 20px;">é‘‘å®šçµæœ</h2>
            
            <div id="chatHistory" class="result-container"></div>
            
            <div id="followUpSection">
                <div class="form-group">
                    <label>ã•ã‚‰ã«è©³ã—ãçŸ¥ã‚ŠãŸã„ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ</label>
                    <textarea id="followUpQuestion" placeholder="è¿½åŠ ã®è³ªå•ã‚’ã©ã†ã..."></textarea>
                </div>
                <button class="btn" onclick="askFollowUp()">è³ªå•ã™ã‚‹</button>
                <div class="question-counter" id="questionCounter"></div>
            </div>
            
            <button class="btn back-btn" onclick="backToMenu()">æ–°ã—ã„å ã„ã‚’ã™ã‚‹</button>
        </div>
    </div>

    <script>
        let selectedFortune = '';
        let conversationHistory = [];
        let questionCount = 0;
        const MAX_QUESTIONS = 2;
        const WORKER_URL = 'https://ootasensenraanai.kawai-6f8.workers.dev';

        const fortuneNames = {
            'shichusuimei': 'å››æŸ±æ¨å‘½',
            'tarot': 'ã‚¿ãƒ­ãƒƒãƒˆå ã„',
            'crystal': 'æ°´æ™¶ç‰å ã„',
            'name': 'å§“ååˆ¤æ–­',
            'comprehensive': 'ç·åˆé‘‘å®š',
            'love': 'æ‹æ„›ãƒ»ç›¸æ€§å ã„'
        };

        function selectFortune(type) {
            selectedFortune = type;
            document.getElementById('fortuneTitle').textContent = fortuneNames[type];
            
            // ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.querySelectorAll('.form-group').forEach(group => {
                group.style.display = 'block';
                const input = group.querySelector('input, textarea, select');
                if (input) input.removeAttribute('required');
            });

            // å ã„ã®ç¨®é¡ã«å¿œã˜ã¦è¡¨ç¤ºé …ç›®ã‚’èª¿æ•´
            switch(type) {
                case 'shichusuimei':
                    setRequired(['birthdate', 'birthtime', 'name', 'question']);
                    document.getElementById('questionLabel').innerHTML = 'å ã„ãŸã„å†…å®¹ãƒ»è³ªå• <span class="required">*å¿…é ˆ</span>';
                    break;
                    
                case 'tarot':
                    hideFields(['birthdateGroup', 'birthtimeGroup', 'genderGroup']);
                    setRequired(['question']);
                    setOptional(['name']);
                    document.getElementById('questionLabel').innerHTML = 'å ã„ãŸã„å†…å®¹ï¼ˆéå»ãƒ»ç¾åœ¨ãƒ»æœªæ¥ãªã©ï¼‰ <span class="required">*å¿…é ˆ</span>';
                    break;
                    
                case 'crystal':
                    hideFields(['birthdateGroup', 'birthtimeGroup', 'genderGroup']);
                    setRequired(['question']);
                    setOptional(['name']);
                    document.getElementById('questionLabel').innerHTML = 'çŸ¥ã‚ŠãŸã„ã“ã¨ãƒ»æ‚©ã¿ <span class="required">*å¿…é ˆ</span>';
                    break;
                    
                case 'name':
                    hideFields(['birthtimeGroup']);
                    setRequired(['name', 'question']);
                    setOptional(['birthdate', 'gender']);
                    document.getElementById('questionLabel').innerHTML = 'å ã„ãŸã„å†…å®¹ <span class="required">*å¿…é ˆ</span>';
                    break;
                    
                case 'comprehensive':
                    setRequired(['birthdate', 'birthtime', 'name', 'question']);
                    document.getElementById('questionLabel').innerHTML = 'å ã„ãŸã„å†…å®¹ <span class="required">*å¿…é ˆ</span>';
                    break;
                    
                case 'love':
                    hideFields(['birthtimeGroup']);
                    showFields(['partnerNameGroup', 'partnerBirthdateGroup']);
                    setRequired(['name', 'question']);
                    setOptional(['birthdate', 'gender', 'partnerName', 'partnerBirthdate']);
                    document.getElementById('questionLabel').innerHTML = 'æ‹æ„›ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã„ã“ã¨ <span class="required">*å¿…é ˆ</span>';
                    break;
            }
            
            showScreen('inputScreen');
        }

        function hideFields(fieldIds) {
            fieldIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.style.display = 'none';
            });
        }

        function showFields(fieldIds) {
            fieldIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.style.display = 'block';
            });
        }

        function setRequired(fieldIds) {
            fieldIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.setAttribute('required', 'required');
            });
        }

        function setOptional(fieldIds) {
            fieldIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.removeAttribute('required');
            });
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        document.getElementById('fortuneForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const birthdate = document.getElementById('birthdate').value;
            const birthtime = document.getElementById('birthtime').value;
            const name = document.getElementById('name').value;
            const gender = document.getElementById('gender').value;
            const question = document.getElementById('question').value;
            const partnerName = document.getElementById('partnerName').value;
            const partnerBirthdate = document.getElementById('partnerBirthdate').value;
            
            let prompt = `ã‚ãªãŸã¯çµŒé¨“è±Šå¯Œãªå ã„å¸«ã€Œæ™ºå­ã€ã§ã™ã€‚2026å¹´1æœˆ29æ—¥æ™‚ç‚¹ã§å ã„ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚\n\n`;
            prompt += `å ã„ã®ç¨®é¡: ${fortuneNames[selectedFortune]}\n`;
            
            if (birthdate) prompt += `ç”Ÿå¹´æœˆæ—¥: ${birthdate}\n`;
            if (birthtime) prompt += `å‡ºç”Ÿæ™‚åˆ»: ${birthtime}\n`;
            if (name) prompt += `åå‰: ${name}\n`;
            if (gender) prompt += `æ€§åˆ¥: ${gender}\n`;
            if (partnerName) prompt += `ç›¸æ‰‹ã®åå‰: ${partnerName}\n`;
            if (partnerBirthdate) prompt += `ç›¸æ‰‹ã®ç”Ÿå¹´æœˆæ—¥: ${partnerBirthdate}\n`;
            
            prompt += `\nè³ªå•: ${question}\n\n`;
            prompt += `ä¸Šè¨˜ã®æƒ…å ±ã‚’ã‚‚ã¨ã«ã€${fortuneNames[selectedFortune]}ã§è©³ã—ãå ã£ã¦ãã ã•ã„ã€‚\n`;
            prompt += `å ã„å¸«ã‚‰ã—ã„å„ªã—ãç¥ç§˜çš„ãªèªã‚Šå£ã§ã€å…·ä½“çš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’å«ã‚ã¦1500æ–‡å­—ä»¥ä¸Šã§é‘‘å®šã—ã¦ãã ã•ã„ã€‚`;
            
            conversationHistory = [{ role: 'user', content: question }];
            questionCount = 0;
            
            await callGeminiAPI(prompt, question);
        });

        async function askFollowUp() {
            const followUpQuestion = document.getElementById('followUpQuestion').value.trim();
            
            if (!followUpQuestion) {
                alert('è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            if (questionCount >= MAX_QUESTIONS) {
                alert(`è³ªå•å›æ•°ã‚’ä½¿ã„åˆ‡ã‚Šã¾ã—ãŸã€‚\nãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹ã¨æ–°ã—ã„å ã„ãŒã§ãã¾ã™ã€‚`);
                return;
            }
            
            conversationHistory.push({ role: 'user', content: followUpQuestion });
            
            const prompt = `ã‚ãªãŸã¯å ã„å¸«ã€Œæ™ºå­ã€ã¨ã—ã¦ã€ä»¥ä¸‹ã®ä¼šè©±ã®ç¶šãã§è¿½åŠ ã®è³ªå•ã«ç­”ãˆã¦ãã ã•ã„ã€‚\n\n` +
                         `éå»ã®ä¼šè©±:\n${conversationHistory.map(msg => `${msg.role}: ${msg.content}`).join('\n')}\n\n` +
                         `å ã„å¸«ã‚‰ã—ã„èªã‚Šå£ã§ã€å…·ä½“çš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’800æ–‡å­—ä»¥ä¸Šã§å›ç­”ã—ã¦ãã ã•ã„ã€‚`;
            
            document.getElementById('followUpQuestion').value = '';
            await callGeminiAPI(prompt, followUpQuestion);
        }

        async function callGeminiAPI(prompt, userMessage) {
            showScreen('resultScreen');
            
            addChatMessage('user', userMessage);
            
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'loading';
            loadingDiv.id = 'loading';
            loadingDiv.innerHTML = '<div class="spinner"></div><p>æ™ºå­ãŒå ã„ã®çµæœã‚’èª­ã¿è§£ã„ã¦ã„ã¾ã™...</p>';
            document.getElementById('chatHistory').appendChild(loadingDiv);
            
            try {
                const response = await fetch(WORKER_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: prompt }]
                        }],
                        generationConfig: {
                            temperature: 0.9,
                            maxOutputTokens: 8000,
                        }
                    })
                });

                const data = await response.json();
                
                loadingDiv.remove();
                
                if (data.candidates && data.candidates[0]) {
                    const result = data.candidates[0].content.parts[0].text;
                    addChatMessage('ai', result);
                    conversationHistory.push({ role: 'assistant', content: result });
                    questionCount++;
                    updateQuestionCounter();
                } else {
                    throw new Error('å ã„ã®çµæœã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ');
                }
                
            } catch (error) {
                loadingDiv.remove();
                addChatMessage('ai', 'ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚å ã„ã®çµæœã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
                console.error('Error:', error);
            }
        }

        function addChatMessage(type, message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${type}`;
            messageDiv.innerHTML = `<p>${message.replace(/\n/g, '<br>')}</p>`;
            document.getElementById('chatHistory').appendChild(messageDiv);
            
            messageDiv.scrollIntoView({ behavior: 'smooth', block: 'end' });
        }

        function updateQuestionCounter() {
            const remaining = MAX_QUESTIONS - questionCount;
            const counterText = remaining > 0 
                ? `æ®‹ã‚Š ${remaining} å›è³ªå•ã§ãã¾ã™` 
                : 'è³ªå•å›æ•°ã‚’ä½¿ã„åˆ‡ã‚Šã¾ã—ãŸï¼ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹ã¨æ–°ã—ã„å ã„ãŒã§ãã¾ã™ï¼‰';
            document.getElementById('questionCounter').textContent = counterText;
            
            if (remaining <= 0) {
                document.getElementById('followUpSection').querySelector('.btn').disabled = true;
                document.getElementById('followUpQuestion').disabled = true;
            }
        }

        function backToMenu() {
            showScreen('menuScreen');
            document.getElementById('fortuneForm').reset();
            document.getElementById('chatHistory').innerHTML = '';
            document.getElementById('followUpQuestion').value = '';
            conversationHistory = [];
            questionCount = 0;
            updateQuestionCounter();
            
            document.getElementById('followUpSection').querySelector('.btn').disabled = false;
            document.getElementById('followUpQuestion').disabled = false;
        }

        updateQuestionCounter();
    </script>
</body>
</html>
